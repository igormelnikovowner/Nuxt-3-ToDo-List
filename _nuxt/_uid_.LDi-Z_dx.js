import{n as O,r as p,u as z,g as q,_ as M,s as h,o as a,c as m,a as d,v as H,x as J,b as w,t as n,y as S,z as ne,A as ae,B as I,C as ie,D as v,F as U,E as re,w as k,q as A,d as $}from"./entry.c8Fz298c.js";import{F as K}from"./FormGroup.PgGvA-sy.js";import{B as me}from"./Button.CUEB_LMa.js";import{C as ce,D as ve,u as pe}from"./useDialog.cDNkvZZt.js";const we=O({name:"NoteTodo",props:{todo:{type:Object,default:{}},noteUid:{type:Number,default:0},type:{type:String,default:"add"},reverseType:{type:String,default:""}},components:{FormGroup:K},emits:["change-todo-status","remove-todo","remove-new-todo","back-prev-state","change-todo"],setup(e,u){const f=p(e.todo.title),T=z(),{editTodo:c,deleteTodo:b}=T,l=p(e.todo.isDone);return q(()=>e.todo,()=>{l.value=e.todo.isDone},{deep:!0}),{titlemodel:f,model:l,changeTodoStatus:()=>{if(l.value=!l.value,e.type!=="add"){const B={...e.todo,isDone:l.value};c(B,e.noteUid)}else u.emit("change-todo-status",{uid:e.todo.uid,val:l.value})},backToPrevState:()=>{u.emit("back-prev-state",{uid:e.noteUid,todo:e.todo.uid})},deleteTd:()=>{e.type!=="add"?u.emit("remove-todo",{uid:e.todo.uid}):u.emit("remove-new-todo",{uid:e.todo.uid})},changeTodo:()=>{u.emit("change-todo",e.todo.title)}}}}),fe={class:"flex items-end mb-2 sm:mb-4"},Te={class:"flex items-center sm:items-end mr-2 sm:mr-4 pb-2 sm:pb-0"},ge=["checked"],he={key:0},be={key:1};function De(e,u,f,T,c,b){const l=h("FormGroup");return a(),m("div",fe,[d("div",Te,[H(d("input",{"onUpdate:modelValue":u[0]||(u[0]=s=>e.model=s),checked:e.model,type:"checkbox",class:"w-6 sm:w-10 h-6 sm:h-10",onInput:u[1]||(u[1]=(...s)=>e.changeTodoStatus&&e.changeTodoStatus(...s))},null,40,ge),[[J,e.model]])]),w(l,{modelValue:e.titlemodel,"onUpdate:modelValue":[u[2]||(u[2]=s=>e.titlemodel=s),e.changeTodo],class:"w-2/3 mr-2 sm:mr-4",type:"text",label:"Задача",placeholder:"Введите название задачи"},null,8,["modelValue","onUpdate:modelValue"]),e.type!=="add"&&e.reverseType?(a(),m("div",{key:0,class:"flex text-lg sm:text-xl font-bold cursor-pointer pt-3 sm:pt-5 mr-2 sm:mr-4 underline",onClick:u[3]||(u[3]=(...s)=>e.backToPrevState&&e.backToPrevState(...s))},[e.reverseType==="back"?(a(),m("span",he,n(e.$t("Вернуть название Todo")),1)):(a(),m("span",be,n(e.$t("Отменить изменение Todo")),1))])):S("",!0),d("div",{class:"flex text-lg sm:text-xl font-bold cursor-pointer pt-6 sm:pt-5",onClick:u[4]||(u[4]=(...s)=>e.deleteTd&&e.deleteTd(...s))},[d("span",null,n(e.$t("Удалить")),1)])])}const Ne=M(we,[["render",De]]),ye=O({components:{FormGroup:K,Button:me,Checkbox:ce,NoteTodo:Ne,Dialog:ve},setup(){var R,G,L,j;const e=ne(),u=z(),{addNote:f,editNote:T}=u,{notes:c,isLoading:b}=ae(u),l=I(()=>c.value.some(t=>t.uid===+e.params.uid)?"edit":"add"),s=I(()=>l.value==="add"?{}:c.value.find(t=>t.uid===+e.params.uid)||{});q(()=>s.value,()=>{o.value.uid=s.value.uid,o.value.isDone=s.value.isDone,o.value.title=s.value.title,o.value.todos=s.value.todos},{deep:!0});const o=p({uid:((R=s.value)==null?void 0:R.uid)||+e.params.uid,isDone:((G=s.value)==null?void 0:G.isDone)||!1,title:((L=s.value)==null?void 0:L.title)||"",todos:((j=s.value)==null?void 0:j.todos)||[]}),i=ie({}),r=t=>{const g=o.value.todos.findIndex(C=>C.uid===t.uid);o.value.todos[g].isDone=t.val},B=t=>{y({action:"delete-todo",uid:o.value.uid,todoUid:t.uid})},D=p(""),N=p(null),Q=t=>{D.value="delete-new-todo",N.value=t.uid,y({action:"delete-new-todo",uid:o.value.uid,todoUid:t.uid})},W=()=>{D.value==="delete-new-todo"?o.value.todos=o.value.todos.filter(t=>t.uid!==N.value):D.value==="edit-new-todo"&&(o.value.title=N.value),D.value="",N.value=null},X=t=>{i.isDone=t},Y=t=>{i.title=t},Z=t=>{o.value.title=t},x=()=>{i.title&&(o.value.todos.push({uid:new Date().getTime(),isDone:!!i.isDone,title:i.title}),i.uid=0,i.isDone=!1,i.title="")},{isDialogOpen:_,actionForConfirm:ee,showDialog:y,closeDialog:oe,confirmAction:ue,toNotesLayout:P}=pe(),te=()=>{y({action:"edit",uid:o.value.uid,title:o.value.title}),F.value="back"},se=()=>{y({action:"delete",uid:o.value.uid})},de=()=>{o.value.title&&o.value.todos.length&&(o.value.todos.every(t=>t.isDone)&&(o.value.isDone=!0),f(o.value),P())},F=p(""),V=p("");return{isLoading:b,toNotesLayout:P,newNote:o,type:l,newTodo:i,changeTodoStatus:r,removeTodo:B,removeNewTodo:Q,reverseType:F,backToPrevState:t=>{const g=c.value.find(E=>E.uid===t.uid)||{},C=g.todos.findIndex(E=>E.uid===t.todo),le=o.value.todos[C].title;g.todos[C].title=V.value,T(g),F.value="forward",V.value=le},changeTodo:t=>{V.value=t},changeNewTodoCheckboxValue:X,changeNewTodoTitleValue:Y,changeNewNoteTitleValue:Z,addNewTodoToNote:x,editNote:te,deleteNote:se,addNewNote:de,isDialogOpen:_,actionForConfirm:ee,closeDialog:oe,confirmAction:ue,confirm:W}}}),Ce={key:0,class:"w-full"},ke={class:"flex flex-col items-center mb-6 sm:mb-12 border-2 border-white shadow-xl rounded-xl px-3 sm:px-6 pt-2 sm:pt-4 pb-4 sm:pb-8"},$e={class:"font-bold text-2xl sm:text-4xl text-center mb-6 sm:mb-12"},Se={class:"w-full sm:w-3/5"},Be={class:"flex items-end mb-2 sm:mb-4"},Fe={class:"flex flex-col mb-4 sm:mb-8"},Ve={class:"w-full font-bold text-lg sm:text-xl text-center"},Ee={class:"w-full font-bold text-lg sm:text-xl text-center"},Ue={class:"flex items-center sm:items-end"},Ae={class:"flex items-end mr-2 sm:mr-4 pt-7 sm:pt-0"},Pe=["checked"],Re={key:1},Ge={class:"font-bold text-2xl text-center mb-12"};function Le(e,u,f,T,c,b){const l=h("FormGroup"),s=h("NoteTodo"),o=h("Button"),i=h("Dialog");return a(),m(U,null,[e.isLoading?(a(),m("div",Re,[d("h2",Ge,n(e.$t("Загружаем заметки...")),1)])):(a(),m("div",Ce,[d("div",ke,[d("h2",$e,n(e.type==="add"?e.$t("Заполните данные по новой заметке"):e.$t("Редактирование заметки")),1),d("div",Se,[d("div",Be,[w(l,{"model-value":e.newNote.title,class:"w-full sm:mr-4",type:"text",label:"Заметка",placeholder:"Введите название заметки","onUpdate:modelValue":e.changeNewNoteTitleValue},null,8,["model-value","onUpdate:modelValue"]),e.type!=="add"?(a(),m("div",{key:0,class:v(["flex sm:w-1/12 text-lg sm:text-xl font-bold",e.newNote.title?"cursor-pointer":"cursor-not-allowed"]),onClick:u[0]||(u[0]=(...r)=>e.editNote&&e.editNote(...r))},[d("span",null,n(e.$t("Изменить")),1)],2)):S("",!0)]),d("div",Fe,[d("h3",Ve,n(e.newNote.todos&&e.newNote.todos.length?e.$t("Задачи для выполнения"):e.$t("Нет добавленных задач")),1),e.newNote.todos&&e.newNote.todos.length?(a(!0),m(U,{key:0},re(e.newNote.todos,r=>(a(),A(s,{key:r.uid,"note-uid":e.newNote.uid,todo:r,type:e.type,"reverse-type":e.reverseType,onChangeTodoStatus:e.changeTodoStatus,onRemoveTodo:e.removeTodo,onRemoveNewTodo:e.removeNewTodo,onBackPrevState:e.backToPrevState,onChangeTodo:e.changeTodo},null,8,["note-uid","todo","type","reverse-type","onChangeTodoStatus","onRemoveTodo","onRemoveNewTodo","onBackPrevState","onChangeTodo"]))),128)):S("",!0)]),d("h3",Ee,n(e.$t("Добавьте задачу")),1),d("div",Ue,[w(l,{"model-value":e.newTodo.title,class:"w-2/3 mr-2 sm:mr-4",type:"text",label:"Новая задача",placeholder:"Введите название задачи","onUpdate:modelValue":e.changeNewTodoTitleValue},null,8,["model-value","onUpdate:modelValue"]),d("div",Ae,[H(d("input",{"onUpdate:modelValue":u[1]||(u[1]=r=>e.newTodo.isDone=r),checked:e.newTodo.isDone,type:"checkbox",class:"w-6 sm:w-10 h-6 sm:h-10"},null,8,Pe),[[J,e.newTodo.isDone]])]),d("div",{class:v(["flex text-lg sm:text-xl font-bold sm:pt-8 pt-5",e.newTodo.title?"cursor-pointer":"cursor-not-allowed"]),onClick:u[2]||(u[2]=(...r)=>e.addNewTodoToNote&&e.addNewTodoToNote(...r))},[d("span",null,n(e.$t("Добавить")),1)],2)])])]),d("div",{class:v(["flex justify-center",e.type==="add"?"":"flex-col sm:flex-row items-center"])},[w(o,{class:v(["bg-gray-300 text-white w-60 sm:w-72",e.type!=="add"?"mb-3 sm:mb-0 sm:mr-8":"mr-4 sm:mr-8"]),type:"button",onClick:e.toNotesLayout},{default:k(()=>[$(n(e.$t("Назад")),1)]),_:1},8,["class","onClick"]),e.type==="add"?(a(),A(o,{key:0,class:v(["text-white w-60 sm:w-72",e.newNote.title&&e.newNote.todos.length?"bg-emerald-500":"bg-gray-300 cursor-not-allowed"]),type:"button",onClick:e.addNewNote},{default:k(()=>[$(n(e.$t("Добавить заметку")),1)]),_:1},8,["class","onClick"])):(a(),m(U,{key:1},[w(o,{class:v(["text-white bg-red-500 w-60 sm:w-72",e.type!=="add"?"mb-3 sm:mb-0 sm:mr-8":"mr-4 sm:mr-8"]),type:"button",onClick:e.deleteNote},{default:k(()=>[$(n(e.$t("Удалить заметку")),1)]),_:1},8,["class","onClick"]),w(o,{class:v(["text-white w-60 sm:w-72",e.newNote.title&&e.newNote.todos.length?"bg-emerald-500":"bg-gray-300 cursor-not-allowed"]),type:"button",onClick:e.editNote},{default:k(()=>[$(n(e.$t("Сохранить изменения")),1)]),_:1},8,["class","onClick"])],64))],2)])),e.isDialogOpen?(a(),A(i,{key:2,action:e.actionForConfirm,onCloseDialog:e.closeDialog,onConfirmAction:u[3]||(u[3]=r=>e.confirmAction("note")),onConfirm:e.confirm},null,8,["action","onCloseDialog","onConfirm"])):S("",!0)],64)}const He=M(ye,[["render",Le]]);export{He as default};
